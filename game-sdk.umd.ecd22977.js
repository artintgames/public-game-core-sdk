(function(o,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(o=typeof globalThis<"u"?globalThis:o||self,f(o.coreSDK={}))})(this,(function(o){"use strict";const f="coreSDK_profiles_v1";class tt{constructor(t){this.items=new Map,this.maxItems=t?.maxItems??100,this.loadFromStorage()}get(t){const e=this.items.get(t);if(!e)return null;const i=Date.now();return i-e.cachedAt>e.ttl?(this.items.delete(t),this.saveToStorageSafe(),null):(e.lastAccessed=i,e.profile)}set(t,e){const i=Date.now(),n={profile:t,cachedAt:i,lastAccessed:i,ttl:e};this.items.set(t.gid,n),this.evictIfNeeded(),this.saveToStorageSafe()}invalidate(t){this.items.delete(t)&&this.saveToStorageSafe()}invalidateAll(){this.items.clear(),this.saveToStorageSafe()}evictIfNeeded(){if(this.items.size<=this.maxItems)return;const t=Array.from(this.items.entries());t.sort((i,n)=>i[1].lastAccessed-n[1].lastAccessed);const e=t.length-this.maxItems;for(let i=0;i<e;i++){const[n]=t[i];this.items.delete(n)}}loadFromStorage(){if(!(typeof localStorage>"u"))try{const t=localStorage.getItem(f);if(!t)return;const e=JSON.parse(t);if(e.version!==1||!e.items||typeof e.items!="object")return;const i=Date.now();for(const[n,r]of Object.entries(e.items))!r||!r.profile||typeof r.cachedAt!="number"||typeof r.ttl!="number"||i-r.cachedAt>r.ttl||this.items.set(n,r);this.evictIfNeeded()}catch{}}saveToStorageSafe(){if(!(typeof localStorage>"u"))try{const t={};for(const[i,n]of this.items.entries())t[i]=n;const e={version:1,items:t};localStorage.setItem(f,JSON.stringify(e))}catch{}}}const v={PROFILE_UPDATED:"profile.updated"};class P{constructor(t,e){this.cache=new tt,this.meGid=null,this.api=t,this.events=e}async getMe(){if(this.meGid){const e=this.cache.get(this.meGid);if(e)return e}const t=await this.api.get("/profile/me");return this.meGid=t.gid,this.cache.set(t,3e5),t}async getByGid(t){if(this.meGid===t)return this.getMe();const e=this.cache.get(t);if(e)return e;const i=await this.api.get(`/profile/${t}`);return this.cache.set(i,6e5),i}async update(t){const e=await this.api.put("/profile/me",t);return this.meGid=e.gid,this.cache.set(e,3e5),this.events.emit(v.PROFILE_UPDATED,{gid:e.gid,profile:e}),typeof window<"u"&&window.dispatchEvent(new CustomEvent(v.PROFILE_UPDATED,{detail:{gid:e.gid,profile:e}})),e}async getSummary(t){let e=t;return e||(e=(await this.getMe()).gid),this.api.get(`/profile/${e}/summary`)}async getSummaryBatch(t){return(await this.api.post("/profile/batch",{gids:t})).profiles??[]}invalidate(t){this.cache.invalidate(t)}invalidateAll(){this.cache.invalidateAll()}}const m={baseUrl:"http://localhost:80/v1",authUrl:"http://localhost:3001"};function L(s){m.baseUrl=s}function R(s){m.authUrl=s}class k{constructor(t){this.getAuthToken=t}buildUrl(t){const e=m.baseUrl.replace(/\/+$/,""),i=t.replace(/^\/+/,"");return`${e}/${i}`}async request(t,e={}){const i=this.buildUrl(t),n=this.getAuthToken(),r={"Content-Type":"application/json",...e.headers};n&&(r.Authorization=`Bearer ${n}`),console.log("[API] REQUEST:",{url:i,method:e.method??"GET",headers:r,body:e.body});const a=await fetch(i,{...e,headers:r,credentials:"include"});if(!a.ok)throw new Error(`Request failed with status ${a.status}`);const c=await a.text();if(!c)return null;try{return JSON.parse(c)}catch{return c}}normalizeBody(t){return t===void 0?void 0:JSON.stringify(t)}send(t,e,i){return this.request(e,{method:t,body:this.normalizeBody(i)})}get(t){return this.send("GET",t)}post(t,e){return this.send("POST",t,e)}put(t,e){return this.send("PUT",t,e)}patch(t,e){return this.send("PATCH",t,e)}delete(t){return this.send("DELETE",t)}}class O{constructor(){this.listeners=new Map,this.onceListeners=new Map}on(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}once(t,e){this.onceListeners.has(t)||this.onceListeners.set(t,new Set),this.onceListeners.get(t).add(e)}off(t,e){this.listeners.get(t)?.delete(e),this.onceListeners.get(t)?.delete(e)}emit(t,...e){this.listeners.get(t)?.forEach(n=>n(...e));const i=this.onceListeners.get(t);i&&(i.forEach(n=>n(...e)),this.onceListeners.delete(t))}}const p=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,u=globalThis,S="10.27.0";function U(){return C(u),u}function C(s){const t=s.__SENTRY__=s.__SENTRY__||{};return t.version=t.version||S,t[S]=t[S]||{}}function T(s,t,e=u){const i=e.__SENTRY__=e.__SENTRY__||{},n=i[S]=i[S]||{};return n[s]||(n[s]=t())}const et="Sentry Logger ",K={};function st(s){if(!("console"in u))return s();const t=u.console,e={},i=Object.keys(K);i.forEach(n=>{const r=K[n];e[n]=t[n],t[n]=r});try{return s()}finally{i.forEach(n=>{t[n]=e[n]})}}function it(){b().enabled=!0}function nt(){b().enabled=!1}function N(){return b().enabled}function rt(...s){w("log",...s)}function ot(...s){w("warn",...s)}function at(...s){w("error",...s)}function w(s,...t){p&&N()&&st(()=>{u.console[s](`${et}[${s}]:`,...t)})}function b(){return p?T("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const E={enable:it,disable:nt,isEnabled:N,log:rt,warn:ot,error:at},ct=Object.prototype.toString;function ht(s,t){return ct.call(s)===`[object ${t}]`}function ut(s){return ht(s,"Object")}function lt(s){return!!(s?.then&&typeof s.then=="function")}function dt(s,t,e){try{Object.defineProperty(s,t,{value:e,writable:!0,configurable:!0})}catch{p&&E.log(`Failed to add non-enumerable property "${t}" to object`,s)}}function gt(s,t=0){return typeof s!="string"||t===0||s.length<=t?s:`${s.slice(0,t)}...`}function ft(){const s=u;return s.crypto||s.msCrypto}let A;function pt(){return Math.random()*16}function y(s=ft()){try{if(s?.randomUUID)return s.randomUUID().replace(/-/g,"")}catch{}return A||(A="10000000100040008000"+1e11),A.replace(/[018]/g,t=>(t^(pt()&15)>>t/4).toString(16))}const $=1e3;function B(){return Date.now()/$}function _t(){const{performance:s}=u;if(!s?.now||!s.timeOrigin)return B;const t=s.timeOrigin;return()=>(t+s.now())/$}let M;function mt(){return(M??(M=_t()))()}function St(s,t={}){if(t.user&&(!s.ipAddress&&t.user.ip_address&&(s.ipAddress=t.user.ip_address),!s.did&&!t.did&&(s.did=t.user.id||t.user.email||t.user.username)),s.timestamp=t.timestamp||mt(),t.abnormal_mechanism&&(s.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(s.ignoreDuration=t.ignoreDuration),t.sid&&(s.sid=t.sid.length===32?t.sid:y()),t.init!==void 0&&(s.init=t.init),!s.did&&t.did&&(s.did=`${t.did}`),typeof t.started=="number"&&(s.started=t.started),s.ignoreDuration)s.duration=void 0;else if(typeof t.duration=="number")s.duration=t.duration;else{const e=s.timestamp-s.started;s.duration=e>=0?e:0}t.release&&(s.release=t.release),t.environment&&(s.environment=t.environment),!s.ipAddress&&t.ipAddress&&(s.ipAddress=t.ipAddress),!s.userAgent&&t.userAgent&&(s.userAgent=t.userAgent),typeof t.errors=="number"&&(s.errors=t.errors),t.status&&(s.status=t.status)}function F(s,t,e=2){if(!t||typeof t!="object"||e<=0)return t;if(s&&Object.keys(t).length===0)return s;const i={...s};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=F(i[n],t[n],e-1));return i}function G(){return y()}const D="_sentrySpan";function x(s,t){t?dt(s,D,t):delete s[D]}function H(s){return s[D]}const yt=100;class l{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:G(),sampleRand:Math.random()}}clone(){const t=new l;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._attributes={...this._attributes},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,x(t,H(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&St(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,e){return this.setTags({[t]:e})}setAttributes(t){return this._attributes={...this._attributes,...t},this._notifyScopeListeners(),this}setAttribute(t,e){return this.setAttributes({[t]:e})}removeAttribute(t){return t in this._attributes&&(delete this._attributes[t],this._notifyScopeListeners()),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,e){return this._extra={...this._extra,[t]:e},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return e===null?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const e=typeof t=="function"?t(this):t,i=e instanceof l?e.getScopeData():ut(e)?t:void 0,{tags:n,attributes:r,extra:a,user:c,contexts:I,level:g,fingerprint:h=[],propagationContext:Z}=i||{};return this._tags={...this._tags,...n},this._attributes={...this._attributes,...r},this._extra={...this._extra,...a},this._contexts={...this._contexts,...I},c&&Object.keys(c).length&&(this._user=c),g&&(this._level=g),h.length&&(this._fingerprint=h),Z&&(this._propagationContext=Z),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,x(this,void 0),this._attachments=[],this.setPropagationContext({traceId:G(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,e){const i=typeof e=="number"?e:yt;if(i<=0)return this;const n={timestamp:B(),...t,message:t.message?gt(t.message,2048):t.message};return this._breadcrumbs.push(n),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:H(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=F(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,e){const i=e?.event_id||y();if(!this._client)return p&&E.warn("No client configured on scope - will not capture exception!"),i;const n=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:n,...e,event_id:i},this),i}captureMessage(t,e,i){const n=i?.event_id||y();if(!this._client)return p&&E.warn("No client configured on scope - will not capture message!"),n;const r=i?.syntheticException??new Error(t);return this._client.captureMessage(t,e,{originalException:t,syntheticException:r,...i,event_id:n},this),n}captureEvent(t,e){const i=e?.event_id||y();return this._client?(this._client.captureEvent(t,{...e,event_id:i},this),i):(p&&E.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function Et(){return T("defaultCurrentScope",()=>new l)}function vt(){return T("defaultIsolationScope",()=>new l)}class Ct{constructor(t,e){let i;t?i=t:i=new l;let n;e?n=e:n=new l,this._stack=[{scope:i}],this._isolationScope=n}withScope(t){const e=this._pushScope();let i;try{i=t(e)}catch(n){throw this._popScope(),n}return lt(i)?i.then(n=>(this._popScope(),n),n=>{throw this._popScope(),n}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function _(){const s=U(),t=C(s);return t.stack=t.stack||new Ct(Et(),vt())}function Tt(s){return _().withScope(s)}function wt(s,t){const e=_();return e.withScope(()=>(e.getStackTop().scope=s,t(s)))}function q(s){return _().withScope(()=>s(_().getIsolationScope()))}function bt(){return{withIsolationScope:q,withScope:Tt,withSetScope:wt,withSetIsolationScope:(s,t)=>q(t),getCurrentScope:()=>_().getScope(),getIsolationScope:()=>_().getIsolationScope()}}function At(s){const t=C(s);return t.acs?t.acs:bt()}function Dt(){const s=U();return At(s).getCurrentScope()}function Ut(s){}function It(s,t){return Dt().captureException(s,void 0)}class J{constructor(t){this.apiClient=t}async init(t){return this.apiClient.post("/v1/configs/init",t)}async fetch(t){return this.apiClient.post("/v1/configs/fetch",t)}}class z{constructor(t){this.apiClient=t}async getAll(){return this.apiClient.get("/v1/ab-tests")}async getActive(){return this.apiClient.get("/v1/ab-tests/active")}async getById(t){return this.apiClient.get(`/v1/ab-tests/${t}`)}async create(t){return this.apiClient.post("/v1/ab-tests",t)}async update(t,e){return this.apiClient.request(`/v1/ab-tests/${t}`,{method:"PUT",body:JSON.stringify(e)})}async patch(t,e){return this.apiClient.request(`/v1/ab-tests/${t}`,{method:"PATCH",body:JSON.stringify(e)})}async delete(t){return this.apiClient.request(`/v1/ab-tests/${t}`,{method:"DELETE"})}}class j{constructor(t){this.apiClient=t}async getAll(){return this.apiClient.get("/v1/remote-configs")}async getById(t){return this.apiClient.get(`/v1/remote-configs/${t}`)}async create(t){return this.apiClient.post("/v1/remote-configs",t)}async update(t,e){return this.apiClient.request(`/v1/remote-configs/${t}`,{method:"PATCH",body:JSON.stringify(e)})}async delete(t){return this.apiClient.request(`/v1/remote-configs/${t}`,{method:"DELETE"})}}class Y{constructor(t){this.apiClient=t}async getAll(){return this.apiClient.get("/v1/segments")}async getById(t){return this.apiClient.get(`/v1/segments/${t}`)}async create(t){return this.apiClient.post("/v1/segments",t)}async update(t,e){return this.apiClient.request(`/v1/segments/${t}`,{method:"PATCH",body:JSON.stringify(e)})}async delete(t){return this.apiClient.request(`/v1/segments/${t}`,{method:"DELETE"})}}class V{constructor(t){this.apiClient=t}async getAll(){return this.apiClient.get("/v1/users")}async getById(t){return this.apiClient.get(`/v1/users/${t}`)}async create(t){return this.apiClient.post("/v1/users",t)}async update(t,e){return this.apiClient.request(`/v1/users/${t}`,{method:"PATCH",body:JSON.stringify(e)})}async delete(t){return this.apiClient.request(`/v1/users/${t}`,{method:"DELETE"})}}class X{constructor(t){this.apiClient=t}async getVersion(){return this.apiClient.get("/v1")}async check(){return this.apiClient.get("/v1/health")}}class Q{constructor(t){this.getAuthToken=t}buildUrl(t){const e=m.authUrl.replace(/\/+$/,""),i=t.replace(/^\/+/,"");return`${e}/${i}`}async request(t,e={}){const i=this.buildUrl(t),n=this.getAuthToken(),r={"Content-Type":"application/json",...e.headers};n&&(r.Authorization=`Bearer ${n}`);const a=await fetch(i,{...e,headers:r,credentials:"include"});if(!a.ok){const I=await a.text();let g=`Request failed with status ${a.status}`;try{const h=JSON.parse(I);Array.isArray(h.message)?g=h.message.join(", "):h.message?g=h.message:h.error&&(g=h.error)}catch{}throw new Error(g)}const c=await a.text();if(!c)return null;try{return JSON.parse(c)}catch{return c}}async login(t){return this.request("/v1/auth/login",{method:"POST",body:JSON.stringify(t)})}async register(t){return this.request("/v1/auth/registration",{method:"POST",body:JSON.stringify(t)})}async logout(){return this.request("/v1/auth/logout",{method:"POST"})}async getMe(){return this.request("/v1/auth/me",{method:"GET"})}async refresh(){return this.request("/v1/auth/refresh",{method:"POST"})}}class d{constructor(){this.eventBus=new O,this.systemParams={},this.initialized=!1,this.detectEnvironment(),this.apiClient=new k(()=>this.systemParams.authToken),this.configs=new J(this.apiClient),this.abTests=new z(this.apiClient),this.remoteConfigs=new j(this.apiClient),this.segments=new Y(this.apiClient),this.users=new V(this.apiClient),this.health=new X(this.apiClient),this.auth=new Q(()=>this.systemParams.authToken)}static getInstance(){return d.instance||(d.instance=new d),d.instance}async init(t){if(this.systemParams.authToken){console.log("[SDK] init: TOKEN ALREADY SET → SKIP GUEST AUTH"),this.profileClient=new P(this.apiClient,this.eventBus),this.initialized=!0;return}if(!this.systemParams.authToken&&!this.initialized){console.log("[SDK] init: start",t);try{t?.baseUrl&&(console.log("[SDK] init: set base url ->",t.baseUrl),L(t.baseUrl)),t?.authUrl&&(console.log("[SDK] init: set auth url ->",t.authUrl),R(t.authUrl)),console.log("[SDK] init: set system params ->",t),t&&this.setSystemParams(t),console.log("[SDK] init: ensure device id…");const e=await this.ensureDeviceId();console.log("[SDK] init: deviceId =",e),this.systemParams.deviceId=e,t?.skipAuth?console.log("[SDK] init: skipAuth=true, skipping guest auth"):(console.log("[SDK] init: guest auth…"),await this.authGuest(),console.log("[SDK] init: guest auth OK")),this.profileClient=new P(this.apiClient,this.eventBus),console.log("[SDK] init: profile module initialized"),this.on(v.PROFILE_UPDATED,i=>{try{const n=i?.gid??i?.detail?.gid;n&&(console.log("[SDK] profile cache invalidated for",n),this.profileClient.invalidate(n))}catch{}}),this.initialized=!0,console.log("[SDK] init: COMPLETE"),this.eventBus.emit("core:initialized",this.getSystemParams())}catch(e){throw console.error("[SDK] init: ERROR",e),this.captureError(e),e}}}captureError(t){try{It(t)}catch{}}async authGuest(){try{console.log("[SDK] authGuest: start");const t=this.getStoredToken();if(t){this.systemParams.authToken=t;return}console.log("[SDK] authGuest: sending POST /auth/guest",{deviceId:this.systemParams.deviceId});const e=await this.apiClient.post("/auth/guest",{deviceId:this.systemParams.deviceId});console.log("[SDK] authGuest: server response",e);const i=e?.accessToken??e?.data?.accessToken??null;if(!i)throw console.error("[SDK] authGuest: ERROR missing token",e),new Error("Guest auth failed: missing token");this.storeToken(i),this.systemParams.authToken=i}catch(t){throw console.error("[SDK] authGuest: ERROR",t),this.captureError(t),t}}setSystemParams(t){this.systemParams={...this.systemParams,...t}}getSystemParams(){return{...this.systemParams}}get api(){return this.apiClient}on(t,e){this.eventBus.on(t,e)}once(t,e){this.eventBus.once(t,e)}off(t,e){this.eventBus.off(t,e)}emit(t,...e){this.eventBus.emit(t,...e)}detectEnvironment(){const t=typeof navigator<"u"?navigator.userAgent:"",e=typeof window<"u"&&typeof window.cordova<"u";this.systemParams.os=this.detectOS(t),this.systemParams.isCordova=e}detectOS(t){return/android/i.test(t)?"android":/iPad|iPhone|iPod/i.test(t)?"ios":/Win/i.test(t)?"windows":/Mac/i.test(t)?"macos":/Linux/i.test(t)?"linux":"unknown"}async ensureDeviceId(){const t=this.getStoredDeviceId();if(t)return t;const e=await this.tryGetCordovaDeviceId();if(e)return this.storeDeviceId(e),e;const i=this.generateGuid();return this.storeDeviceId(i),i}getStoredDeviceId(){try{return localStorage.getItem("coreSDK_deviceId")}catch{return null}}storeDeviceId(t){try{localStorage.setItem("coreSDK_deviceId",t)}catch{}}getStoredToken(){try{return localStorage.getItem("coreSDK_token")}catch{return null}}storeToken(t){try{localStorage.setItem("coreSDK_token",t)}catch{}}setUser(t){this.systemParams.user=t}async login(t){try{console.log("[SDK] login: start",{email:t.email});const e=await this.auth.login(t);console.log("[SDK] login: server response received");const i=e?.accessToken??null;if(!i)throw console.error("[SDK] login: ERROR missing token",e),new Error("Login failed: missing token");return this.storeToken(i),this.systemParams.authToken=i,e.user&&this.setUser(e.user),e}catch(e){throw console.error("[SDK] login: ERROR",e),this.captureError(e),e}}async register(t){try{console.log("[SDK] register: start",{email:t.email,username:t.username});const e=await this.auth.register(t);if(console.log("[SDK] register: server response received"),!e)throw console.error("[SDK] register: ERROR missing user data"),new Error("Registration failed: missing user data");return e}catch(e){throw console.error("[SDK] register: ERROR",e),this.captureError(e),e}}async logout(){try{console.log("[SDK] logout: start");try{await this.auth.logout()}catch{}this.clearToken(),this.systemParams.authToken=void 0,this.systemParams.user=null,console.log("[SDK] logout: COMPLETE")}catch(t){throw console.error("[SDK] logout: ERROR",t),this.captureError(t),t}}clearToken(){try{localStorage.removeItem("coreSDK_token")}catch{}}async tryGetCordovaDeviceId(){if(typeof window>"u")return null;const t=window;return t.device?.uuid?String(t.device.uuid):null}generateGuid(){const t=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`}get profile(){return this.profileClient}}const W=d.getInstance();typeof window<"u"&&(window.coreSDK=W),o.AbTestsApiClient=z,o.ApiClient=k,o.AuthApiClient=Q,o.ConfigsApiClient=J,o.CoreSDK=d,o.EventBus=O,o.HealthApiClient=X,o.RemoteConfigsApiClient=j,o.SegmentsApiClient=Y,o.UsersApiClient=V,o.coreSDK=W,o.sdkConfig=m,o.setAuthUrl=R,o.setBaseUrl=L,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));
